
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Erfan Zare Chavoshi">
      
      
      
        <link rel="prev" href="../generated-modules-attention_module/">
      
      
        <link rel="next" href="../generated-modules-_blockwise_attention/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.25">
    
    
      
        <title>Auto Easydel Model - EasyDeL</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#modulesauto_easydel_model" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="EasyDeL" class="md-header__button md-logo" aria-label="EasyDeL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EasyDeL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Auto Easydel Model
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/erfanzar/EasyDeL" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="EasyDeL" class="md-nav__button md-logo" aria-label="EasyDeL" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    EasyDeL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/erfanzar/EasyDeL" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    APIs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            APIs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1" >
        
          
          <label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cli
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1">
            <span class="md-nav__icon md-icon"></span>
            Cli
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-cli-cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cli
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_1_2" id="__nav_1_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Train
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            Train
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-cli-train-cl_train_cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cl Train Cli
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
        
          
          <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Data Preprocessing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_2">
            <span class="md-nav__icon md-icon"></span>
            Data Preprocessing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-data_preprocessing-data_processor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Processor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_3" >
        
          
          <label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Etils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_3">
            <span class="md-nav__icon md-icon"></span>
            Etils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-auto_tx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auto Tx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-configs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-easystate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easystate
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-etils-etils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Etils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4" checked>
        
          
          <label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Modules
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_4">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_1" >
        
          
          <label class="md-nav__link" for="__nav_1_4_1" id="__nav_1_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Arctic
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_1">
            <span class="md-nav__icon md-icon"></span>
            Arctic
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-arctic-arctic_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Arctic Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-arctic-modelling_arctic_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Arctic Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-attention_module/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attention Module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Auto Easydel Model
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Auto Easydel Model
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model" class="md-nav__link">
    <span class="md-ellipsis">
      auto_easydel_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoEasyDeLConfig" class="md-nav__link">
    <span class="md-ellipsis">
      AutoEasyDeLConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutoEasyDeLConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoEasyDeLConfig.from_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      from_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoEasyDeLModelForCausalLM" class="md-nav__link">
    <span class="md-ellipsis">
      AutoEasyDeLModelForCausalLM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutoEasyDeLModelForCausalLM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoEasyDeLModelForCausalLM.from_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      from_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions" class="md-nav__link">
    <span class="md-ellipsis">
      AutoShardAndGatherFunctions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutoShardAndGatherFunctions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_config" class="md-nav__link">
    <span class="md-ellipsis">
      from_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      from_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.get_modules_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_modules_by_type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.is_flatten" class="md-nav__link">
    <span class="md-ellipsis">
      is_flatten
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-_blockwise_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blockwise Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_5" >
        
          
          <label class="md-nav__link" for="__nav_1_4_5" id="__nav_1_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Cohere
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_5">
            <span class="md-nav__icon md-icon"></span>
            Cohere
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-cohere-cohere_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cohere Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-cohere-modelling_cohere_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Cohere Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_6" >
        
          
          <label class="md-nav__link" for="__nav_1_4_6" id="__nav_1_4_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dbrx
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_6">
            <span class="md-nav__icon md-icon"></span>
            Dbrx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-dbrx-dbrx_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dbrx Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-dbrx-modelling_dbrx_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Dbrx Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_7" >
        
          
          <label class="md-nav__link" for="__nav_1_4_7" id="__nav_1_4_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Deepseek V2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_7">
            <span class="md-nav__icon md-icon"></span>
            Deepseek V2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-deepseek_v2-deepseek_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deepseek Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-deepseek_v2-modeling_deepseek_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Deepseek Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-easydel_modelling_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easydel Modelling Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_9" >
        
          
          <label class="md-nav__link" for="__nav_1_4_9" id="__nav_1_4_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Falcon
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_9">
            <span class="md-nav__icon md-icon"></span>
            Falcon
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-falcon-falcon_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Falcon Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-falcon-modelling_falcon_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Falcon Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-flax_modelling_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flax Modelling Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_11" >
        
          
          <label class="md-nav__link" for="__nav_1_4_11" id="__nav_1_4_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gemma
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_11">
            <span class="md-nav__icon md-icon"></span>
            Gemma
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gemma-gemma_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gemma Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gemma-modelling_gemma_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Gemma Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_12" >
        
          
          <label class="md-nav__link" for="__nav_1_4_12" id="__nav_1_4_12_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gpt J
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_12">
            <span class="md-nav__icon md-icon"></span>
            Gpt J
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt_j-gpt_j_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gpt J Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt_j-modelling_gpt_j_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Gpt J Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_13" >
        
          
          <label class="md-nav__link" for="__nav_1_4_13" id="__nav_1_4_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gpt Neo X
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_13">
            <span class="md-nav__icon md-icon"></span>
            Gpt Neo X
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt_neo_x-gpt_neo_x_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gpt Neo X Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt_neo_x-modelling_gpt_neo_x_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Gpt Neo X Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_14" >
        
          
          <label class="md-nav__link" for="__nav_1_4_14" id="__nav_1_4_14_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Gpt2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_14">
            <span class="md-nav__icon md-icon"></span>
            Gpt2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt2-gpt2_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gpt2 Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-gpt2-modelling_gpt2_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Gpt2 Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_15" >
        
          
          <label class="md-nav__link" for="__nav_1_4_15" id="__nav_1_4_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Grok 1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_15">
            <span class="md-nav__icon md-icon"></span>
            Grok 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-grok_1-grok_1_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grok 1 Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-grok_1-modelling_grok_1_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Grok 1 Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_16" >
        
          
          <label class="md-nav__link" for="__nav_1_4_16" id="__nav_1_4_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Jetmoe
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_16">
            <span class="md-nav__icon md-icon"></span>
            Jetmoe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-jetmoe-jetmoe_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jetmoe Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-jetmoe-modelling_jetmoe_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Jetmoe Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_17" >
        
          
          <label class="md-nav__link" for="__nav_1_4_17" id="__nav_1_4_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Llama
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_17">
            <span class="md-nav__icon md-icon"></span>
            Llama
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-llama-llama_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-llama-modelling_llama_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Llama Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-llama-modelling_vision_llama_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Vision Llama Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-llama-vision_llama_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Llama Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_18" >
        
          
          <label class="md-nav__link" for="__nav_1_4_18" id="__nav_1_4_18_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Lucid Transformer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_18">
            <span class="md-nav__icon md-icon"></span>
            Lucid Transformer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-lucid_transformer-lt_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lt Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-lucid_transformer-modelling_lt_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Lt Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_19" >
        
          
          <label class="md-nav__link" for="__nav_1_4_19" id="__nav_1_4_19_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mamba
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_19_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_19">
            <span class="md-nav__icon md-icon"></span>
            Mamba
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mamba-mamba_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mamba Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mamba-modelling_mamba_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Mamba Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_20" >
        
          
          <label class="md-nav__link" for="__nav_1_4_20" id="__nav_1_4_20_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mistral
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_20_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_20">
            <span class="md-nav__icon md-icon"></span>
            Mistral
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mistral-mistral_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mistral Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mistral-modelling_mistral_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Mistral Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mistral-modelling_vision_mistral_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Vision Mistral Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mistral-vision_mistral_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Mistral Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_21" >
        
          
          <label class="md-nav__link" for="__nav_1_4_21" id="__nav_1_4_21_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mixtral
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_21_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_21">
            <span class="md-nav__icon md-icon"></span>
            Mixtral
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mixtral-mixtral_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mixtral Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mixtral-modelling_mixtral_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Mixtral Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_22" >
        
          
          <label class="md-nav__link" for="__nav_1_4_22" id="__nav_1_4_22_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Mosaic Mpt
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_22_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_22">
            <span class="md-nav__icon md-icon"></span>
            Mosaic Mpt
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mosaic_mpt-modelling_mpt_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Mpt Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-mosaic_mpt-mosaic_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mosaic Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_23" >
        
          
          <label class="md-nav__link" for="__nav_1_4_23" id="__nav_1_4_23_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Olmo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_23_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_23">
            <span class="md-nav__icon md-icon"></span>
            Olmo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-olmo-modelling_olmo_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Olmo Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-olmo-olmo_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Olmo Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_24" >
        
          
          <label class="md-nav__link" for="__nav_1_4_24" id="__nav_1_4_24_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Openelm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_24_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_24">
            <span class="md-nav__icon md-icon"></span>
            Openelm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-openelm-modelling_openelm_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Openelm Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-openelm-openelm_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Openelm Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_25" >
        
          
          <label class="md-nav__link" for="__nav_1_4_25" id="__nav_1_4_25_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Opt
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_25_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_25">
            <span class="md-nav__icon md-icon"></span>
            Opt
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-opt-modelling_opt_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Opt Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-opt-opt_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Opt Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_26" >
        
          
          <label class="md-nav__link" for="__nav_1_4_26" id="__nav_1_4_26_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Palm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_26_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_26">
            <span class="md-nav__icon md-icon"></span>
            Palm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-palm-modelling_palm_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Palm Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-palm-palm_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Palm Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_27" >
        
          
          <label class="md-nav__link" for="__nav_1_4_27" id="__nav_1_4_27_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Phi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_27_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_27">
            <span class="md-nav__icon md-icon"></span>
            Phi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-phi-modelling_phi_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Phi Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-phi-phi_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phi Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_28" >
        
          
          <label class="md-nav__link" for="__nav_1_4_28" id="__nav_1_4_28_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Phi3
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_28_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_28">
            <span class="md-nav__icon md-icon"></span>
            Phi3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-phi3-modelling_phi3_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Phi3 Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-phi3-phi3_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Phi3 Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_29" >
        
          
          <label class="md-nav__link" for="__nav_1_4_29" id="__nav_1_4_29_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Qwen1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_29_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_29">
            <span class="md-nav__icon md-icon"></span>
            Qwen1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen1-modelling_qwen1_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Qwen1 Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen1-qwen1_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Qwen1 Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_30" >
        
          
          <label class="md-nav__link" for="__nav_1_4_30" id="__nav_1_4_30_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Qwen2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_30_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_30">
            <span class="md-nav__icon md-icon"></span>
            Qwen2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen2-modelling_qwen_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Qwen Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen2-qwen_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Qwen Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_31" >
        
          
          <label class="md-nav__link" for="__nav_1_4_31" id="__nav_1_4_31_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Qwen2 Moe
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_31_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_31">
            <span class="md-nav__icon md-icon"></span>
            Qwen2 Moe
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen2_moe-configuration_qwen2_moe/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration Qwen2 Moe
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-qwen2_moe-modeling_qwen2_moe_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Qwen2 Moe Flax
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-_ring_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ring Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_33" >
        
          
          <label class="md-nav__link" for="__nav_1_4_33" id="__nav_1_4_33_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Roberta
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_33_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_33">
            <span class="md-nav__icon md-icon"></span>
            Roberta
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-roberta-modelling_roberta_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Roberta Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-roberta-roberta_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Roberta Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_34" >
        
          
          <label class="md-nav__link" for="__nav_1_4_34" id="__nav_1_4_34_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Rwkv
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_34_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_34">
            <span class="md-nav__icon md-icon"></span>
            Rwkv
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-rwkv-modelling_rwkv_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Rwkv Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-rwkv-rwkv_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rwkv Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_35" >
        
          
          <label class="md-nav__link" for="__nav_1_4_35" id="__nav_1_4_35_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Stablelm
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_35_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_35">
            <span class="md-nav__icon md-icon"></span>
            Stablelm
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-stablelm-modelling_stablelm_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Stablelm Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-stablelm-stablelm_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stablelm Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_36" >
        
          
          <label class="md-nav__link" for="__nav_1_4_36" id="__nav_1_4_36_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    T5
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_36_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_36">
            <span class="md-nav__icon md-icon"></span>
            T5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-t5-modelling_t5_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling T5 Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-t5-t5_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    T5 Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-_vanilla_attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vanilla Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_4_38" >
        
          
          <label class="md-nav__link" for="__nav_1_4_38" id="__nav_1_4_38_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Whisper
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_4_38_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_4_38">
            <span class="md-nav__icon md-icon"></span>
            Whisper
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-whisper-modelling_whisper_flax/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Whisper Flax
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-modules-whisper-whisper_configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Whisper Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Reinforcement Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            Reinforcement Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_2" >
        
          
          <label class="md-nav__link" for="__nav_1_5_2" id="__nav_1_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_2">
            <span class="md-nav__icon md-icon"></span>
            Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-models-modelling_casual_language_rl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Casual Language Rl
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_3" >
        
          
          <label class="md-nav__link" for="__nav_1_5_3" id="__nav_1_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Trainer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_3">
            <span class="md-nav__icon md-icon"></span>
            Trainer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-partitioner_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Partitioner Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-ppo_config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ppo Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-ppo_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ppo Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-training_configs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Configs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-trainer-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5_4" >
        
          
          <label class="md-nav__link" for="__nav_1_5_4" id="__nav_1_5_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5_4">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-reinforcement_learning-utils-collectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collectors
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Serve
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            Serve
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-serve-serve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serve
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Smi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            Smi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-smi-smi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Smi
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" >
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Trainer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            Trainer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-base_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Base Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8_2" >
        
          
          <label class="md-nav__link" for="__nav_1_8_2" id="__nav_1_8_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Causal Language Model Trainer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8_2">
            <span class="md-nav__icon md-icon"></span>
            Causal Language Model Trainer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-causal_language_model_trainer-causal_language_model_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Causal Language Model Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-causal_language_model_trainer-fwd_bwd_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fwd Bwd Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-causal_language_model_trainer-modeling_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Output
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8_3" >
        
          
          <label class="md-nav__link" for="__nav_1_8_3" id="__nav_1_8_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dpo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_8_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8_3">
            <span class="md-nav__icon md-icon"></span>
            Dpo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-dpo-dpo_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dpo Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-dpo-fwd_bwd_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fwd Bwd Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-dpo-modelling_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-dpo-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8_4" >
        
          
          <label class="md-nav__link" for="__nav_1_8_4" id="__nav_1_8_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Orpo
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8_4">
            <span class="md-nav__icon md-icon"></span>
            Orpo
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-orpo-fwd_bwd_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fwd Bwd Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-orpo-modelling_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-orpo-orpo_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Orpo Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-orpo-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8_5" >
        
          
          <label class="md-nav__link" for="__nav_1_8_5" id="__nav_1_8_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sft
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8_5">
            <span class="md-nav__icon md-icon"></span>
            Sft
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-sft-stf_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stf Trainer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-sft-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-training_configurations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Configurations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8_8" >
        
          
          <label class="md-nav__link" for="__nav_1_8_8" id="__nav_1_8_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vision Causal Language Model Trainer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_1_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8_8">
            <span class="md-nav__icon md-icon"></span>
            Vision Causal Language Model Trainer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-vision_causal_language_model_trainer-fwd_bwd_functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fwd Bwd Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-vision_causal_language_model_trainer-modelling_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modelling Output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-trainer-vision_causal_language_model_trainer-vision_causal_language_model_trainer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Vision Causal Language Model Trainer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Transform
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            Transform
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-transform-easydel_transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easydel Transform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-transform-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-utils-checker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Checker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-utils-prompters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-utils-tensor_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tensor Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generated-utils-utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../AvailableModels.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Available models
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DataProcessing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataProcessing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AttentionModuleExample.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Easy Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../EasyStateExample/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EasyState
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Falcon.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Falcon Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../FineTuningExample/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fine Tuning Example
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Llama.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Llama2.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Llama2 Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../LoRA-TransferLearningExample/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LoRA and Transfer Learning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mistral.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mistral Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Parameter-Quantization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Parameter Quantization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../MosaicMPT.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MosaicMPT Models
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model" class="md-nav__link">
    <span class="md-ellipsis">
      auto_easydel_model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoEasyDeLConfig" class="md-nav__link">
    <span class="md-ellipsis">
      AutoEasyDeLConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutoEasyDeLConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoEasyDeLConfig.from_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      from_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoEasyDeLModelForCausalLM" class="md-nav__link">
    <span class="md-ellipsis">
      AutoEasyDeLModelForCausalLM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutoEasyDeLModelForCausalLM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoEasyDeLModelForCausalLM.from_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      from_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions" class="md-nav__link">
    <span class="md-ellipsis">
      AutoShardAndGatherFunctions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutoShardAndGatherFunctions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_config" class="md-nav__link">
    <span class="md-ellipsis">
      from_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_pretrained" class="md-nav__link">
    <span class="md-ellipsis">
      from_pretrained
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.get_modules_by_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_modules_by_type
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.python.easydel.modules.auto_easydel_model.is_flatten" class="md-nav__link">
    <span class="md-ellipsis">
      is_flatten
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="modulesauto_easydel_model">modules.auto_easydel_model</h1>


<div class="doc doc-object doc-module">



<a id="src.python.easydel.modules.auto_easydel_model"></a>
    <div class="doc doc-contents first">



  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="src.python.easydel.modules.auto_easydel_model.AutoEasyDeLConfig" class="doc doc-heading">
            <code>AutoEasyDeLConfig</code>


</h2>


    <div class="doc doc-contents ">


              <details class="quote">
                <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AutoEasyDeLConfig</span><span class="p">:</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_pretrained</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">pretrained_model_name_or_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">sharding_axis_dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">sharding_axis_names</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp&quot;</span><span class="p">),</span>
            <span class="n">query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">generation_query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">key_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">value_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">generation_bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">attention_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">shard_attention_computation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">backend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EasyDeLPretrainedConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The from_pretrained function is a helper function that allows you to instantiate a model from the pretrained</span>
<span class="sd">        model repository. It takes as input the name of the model (e.g., &#39;bert-base-uncased&#39;) and returns an instance of</span>
<span class="sd">        the class corresponding to your model, with all weights loaded from disk.</span>

<span class="sd">        Args:</span>
<span class="sd">            cls: Create an instance of the class that called this</span>
<span class="sd">                function</span>
<span class="sd">            pretrained_model_name_or_path: str: Identify the model in</span>
<span class="sd">                the huggingface model hub</span>
<span class="sd">            sharding_axis_dims: Sequence[int]: Specify the dimension of</span>
<span class="sd">                each axis in the sharded model</span>
<span class="sd">            sharding_axis_names: Sequence[str]: Specify the order of</span>
<span class="sd">                sharding</span>
<span class="sd">            query_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">                partitioning of the query tensor</span>
<span class="sd">            generation_query_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">                partitioning of the query tensor in</span>
<span class="sd">            key_partition_spec: PartitionSpec: Partition the key matrix</span>
<span class="sd">            value_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">                partitioning of the value tensor</span>
<span class="sd">            bias_partition_spec: PartitionSpec: Specify the Attention</span>
<span class="sd">                Bias partition spec</span>
<span class="sd">            generation_bias_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">                Attention Bias partition spec for generation</span>
<span class="sd">            attention_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">                partitioning of the attention weights</span>
<span class="sd">            shard_attention_computation: bool: whenever to use shard_map</span>
<span class="sd">                for attention</span>
<span class="sd">            backend: Optional[str]: backend to use for model</span>
<span class="sd">            **kwargs: Pass additional arguments to the model and config</span>
<span class="sd">                classes</span>
<span class="sd">        generation process</span>

<span class="sd">        Returns:</span>
<span class="sd">            A Model Config</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">)</span>
        <span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">model_type</span>

        <span class="n">cfg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">trf</span> <span class="o">=</span> <span class="n">get_modules_by_type</span><span class="p">(</span><span class="n">model_type</span><span class="p">)</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="s1">&#39;add_jax_args&#39;</span><span class="p">):</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">add_jax_args</span><span class="p">()</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">add_basic_configurations</span><span class="p">(</span>
            <span class="n">axis_dims</span><span class="o">=</span><span class="n">sharding_axis_dims</span><span class="p">,</span>
            <span class="n">axis_names</span><span class="o">=</span><span class="n">sharding_axis_names</span><span class="p">,</span>
            <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">query_partition_spec</span><span class="p">,</span>
            <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">generation_query_partition_spec</span><span class="p">,</span>
            <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">generation_bias_partition_spec</span><span class="p">,</span>
            <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">key_partition_spec</span><span class="p">,</span>
            <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">value_partition_spec</span><span class="p">,</span>
            <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">bias_partition_spec</span><span class="p">,</span>
            <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">attention_partition_spec</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">shard_attention_computation</span><span class="o">=</span><span class="n">shard_attention_computation</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">cfg</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="src.python.easydel.modules.auto_easydel_model.AutoEasyDeLConfig.from_pretrained" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">,</span> <span class="n">sharding_axis_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sharding_axis_names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">),</span> <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">shard_attention_computation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>The from_pretrained function is a helper function that allows you to instantiate a model from the pretrained
model repository. It takes as input the name of the model (e.g., 'bert-base-uncased') and returns an instance of
the class corresponding to your model, with all weights loaded from disk.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>cls</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Create an instance of the class that called this
function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>pretrained_model_name_or_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>str: Identify the model in
the huggingface model hub</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sharding_axis_dims</code></td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence[int]: Specify the dimension of
each axis in the sharded model</p>
              </div>
            </td>
            <td>
                  <code>(1, -1, 1, 1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sharding_axis_names</code></td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sequence[str]: Specify the order of
sharding</p>
              </div>
            </td>
            <td>
                  <code>(&#39;dp&#39;, &#39;fsdp&#39;, &#39;tp&#39;, &#39;sp&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>query_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PartitionSpec: Specify the
partitioning of the query tensor</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>generation_query_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PartitionSpec: Specify the
partitioning of the query tensor in</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, None, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>key_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PartitionSpec: Partition the key matrix</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>value_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PartitionSpec: Specify the
partitioning of the value tensor</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>bias_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PartitionSpec: Specify the Attention
Bias partition spec</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), None, None, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>generation_bias_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PartitionSpec: Specify the
Attention Bias partition spec for generation</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), None, None, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>attention_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PartitionSpec: Specify the
partitioning of the attention weights</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shard_attention_computation</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>bool: whenever to use shard_map
for attention</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>backend</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional[str]: backend to use for model</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pass additional arguments to the model and config
classes</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>
      <p>generation process</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="src.python.easydel.modules.easydel_modelling_utils.EasyDeLPretrainedConfig" href="../generated-modules-easydel_modelling_utils/#src.python.easydel.modules.easydel_modelling_utils.EasyDeLPretrainedConfig">EasyDeLPretrainedConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A Model Config</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pretrained</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">pretrained_model_name_or_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">sharding_axis_dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">sharding_axis_names</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp&quot;</span><span class="p">),</span>
        <span class="n">query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">generation_query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">key_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">value_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">generation_bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">attention_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">shard_attention_computation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">backend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EasyDeLPretrainedConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The from_pretrained function is a helper function that allows you to instantiate a model from the pretrained</span>
<span class="sd">    model repository. It takes as input the name of the model (e.g., &#39;bert-base-uncased&#39;) and returns an instance of</span>
<span class="sd">    the class corresponding to your model, with all weights loaded from disk.</span>

<span class="sd">    Args:</span>
<span class="sd">        cls: Create an instance of the class that called this</span>
<span class="sd">            function</span>
<span class="sd">        pretrained_model_name_or_path: str: Identify the model in</span>
<span class="sd">            the huggingface model hub</span>
<span class="sd">        sharding_axis_dims: Sequence[int]: Specify the dimension of</span>
<span class="sd">            each axis in the sharded model</span>
<span class="sd">        sharding_axis_names: Sequence[str]: Specify the order of</span>
<span class="sd">            sharding</span>
<span class="sd">        query_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">            partitioning of the query tensor</span>
<span class="sd">        generation_query_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">            partitioning of the query tensor in</span>
<span class="sd">        key_partition_spec: PartitionSpec: Partition the key matrix</span>
<span class="sd">        value_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">            partitioning of the value tensor</span>
<span class="sd">        bias_partition_spec: PartitionSpec: Specify the Attention</span>
<span class="sd">            Bias partition spec</span>
<span class="sd">        generation_bias_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">            Attention Bias partition spec for generation</span>
<span class="sd">        attention_partition_spec: PartitionSpec: Specify the</span>
<span class="sd">            partitioning of the attention weights</span>
<span class="sd">        shard_attention_computation: bool: whenever to use shard_map</span>
<span class="sd">            for attention</span>
<span class="sd">        backend: Optional[str]: backend to use for model</span>
<span class="sd">        **kwargs: Pass additional arguments to the model and config</span>
<span class="sd">            classes</span>
<span class="sd">    generation process</span>

<span class="sd">    Returns:</span>
<span class="sd">        A Model Config</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">)</span>
    <span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">model_type</span>

    <span class="n">cfg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">trf</span> <span class="o">=</span> <span class="n">get_modules_by_type</span><span class="p">(</span><span class="n">model_type</span><span class="p">)</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="s1">&#39;add_jax_args&#39;</span><span class="p">):</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">add_jax_args</span><span class="p">()</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">add_basic_configurations</span><span class="p">(</span>
        <span class="n">axis_dims</span><span class="o">=</span><span class="n">sharding_axis_dims</span><span class="p">,</span>
        <span class="n">axis_names</span><span class="o">=</span><span class="n">sharding_axis_names</span><span class="p">,</span>
        <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">query_partition_spec</span><span class="p">,</span>
        <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">generation_query_partition_spec</span><span class="p">,</span>
        <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">generation_bias_partition_spec</span><span class="p">,</span>
        <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">key_partition_spec</span><span class="p">,</span>
        <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">value_partition_spec</span><span class="p">,</span>
        <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">bias_partition_spec</span><span class="p">,</span>
        <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">attention_partition_spec</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
        <span class="n">shard_attention_computation</span><span class="o">=</span><span class="n">shard_attention_computation</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">cfg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="src.python.easydel.modules.auto_easydel_model.AutoEasyDeLModelForCausalLM" class="doc doc-heading">
            <code>AutoEasyDeLModelForCausalLM</code>


</h2>


    <div class="doc doc-contents ">


      <p>This class provides a convenient way to load and shard pretrained causal language models from the Hugging Face Hub
and convert them into EasyDeL compatible models. It utilizes the EasyDeL library for distributed training and inference
with JAX.</p>
<p>This class inherits from the <code>EasyDeLFlaxPretrainedModel</code> class, providing functionalities for model loading,
parameter sharding, and interaction with the EasyDeL framework.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <pre><code class="language-python">import jax
from easydel import AutoEasyDeLModelForCausalLM

# Load a GPT-2 model on a single CPU
model, params = AutoEasyDeLModelForCausalLM.from_pretrained(
    &quot;gpt2&quot;,
    device=jax.devices(&quot;cpu&quot;)[0]
)

# Load a GPT-2 model sharded across 8 GPUs with data parallelism (DP) and fully sharded data parallelism (FSDP)
model, params = AutoEasyDeLModelForCausalLM.from_pretrained(
    &quot;gpt2&quot;,
    sharding_axis_dims=(1, 8, 1, 1),
    sharding_axis_names=(&quot;dp&quot;, &quot;fsdp&quot;, &quot;tp&quot;, &quot;sp&quot;),
    device=jax.devices(&quot;cpu&quot;)[0] # offload to CPU [OPTIONAL]
)
</code></pre>

              <details class="quote">
                <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AutoEasyDeLModelForCausalLM</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class provides a convenient way to load and shard pretrained causal language models from the Hugging Face Hub</span>
<span class="sd">    and convert them into EasyDeL compatible models. It utilizes the EasyDeL library for distributed training and inference</span>
<span class="sd">    with JAX.</span>

<span class="sd">    This class inherits from the `EasyDeLFlaxPretrainedModel` class, providing functionalities for model loading,</span>
<span class="sd">    parameter sharding, and interaction with the EasyDeL framework.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        None</span>

<span class="sd">    Examples:</span>
<span class="sd">        ```python</span>
<span class="sd">        import jax</span>
<span class="sd">        from easydel import AutoEasyDeLModelForCausalLM</span>

<span class="sd">        # Load a GPT-2 model on a single CPU</span>
<span class="sd">        model, params = AutoEasyDeLModelForCausalLM.from_pretrained(</span>
<span class="sd">            &quot;gpt2&quot;,</span>
<span class="sd">            device=jax.devices(&quot;cpu&quot;)[0]</span>
<span class="sd">        )</span>

<span class="sd">        # Load a GPT-2 model sharded across 8 GPUs with data parallelism (DP) and fully sharded data parallelism (FSDP)</span>
<span class="sd">        model, params = AutoEasyDeLModelForCausalLM.from_pretrained(</span>
<span class="sd">            &quot;gpt2&quot;,</span>
<span class="sd">            sharding_axis_dims=(1, 8, 1, 1),</span>
<span class="sd">            sharding_axis_names=(&quot;dp&quot;, &quot;fsdp&quot;, &quot;tp&quot;, &quot;sp&quot;),</span>
<span class="sd">            device=jax.devices(&quot;cpu&quot;)[0] # offload to CPU [OPTIONAL]</span>
<span class="sd">        )</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_pretrained</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">pretrained_model_name_or_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">devices</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">dtype</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
            <span class="n">param_dtype</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
            <span class="n">precision</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">Precision</span><span class="p">]</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="s2">&quot;fastest&quot;</span><span class="p">),</span>
            <span class="n">sharding_axis_dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">sharding_axis_names</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp&quot;</span><span class="p">),</span>
            <span class="n">query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">generation_query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">key_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">value_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">generation_bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">attention_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">shard_attention_computation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">shard_fns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">backend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">config_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">auto_shard_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">],</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">load_in_8bit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">bit_targeted_params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">verbose_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">EasyDeLFlaxPretrainedModel</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads and shards a pretrained causal language model from the Hugging Face Hub and converts it into an</span>
<span class="sd">        EasyDeL compatible model.</span>

<span class="sd">        Args:</span>
<span class="sd">            pretrained_model_name_or_path (str): Path or name of the pretrained model in the Hugging Face Hub.</span>
<span class="sd">            device (jax.Array, optional): Device to load the model on. Defaults to the first CPU.</span>
<span class="sd">            dtype (jax.numpy.dtype, optional): Data type of the model. Defaults to jax.numpy.float32.</span>
<span class="sd">            param_dtype (jax.numpy.dtype, optional): Data type of the model parameters. Defaults to jax.numpy.float32.</span>
<span class="sd">            precision (jax.lax.Precision, optional): Precision for computations. Defaults to jax.lax.Precision(&quot;fastest&quot;).</span>
<span class="sd">            sharding_axis_dims (Sequence[int], optional): Dimensions of each sharding axis. Defaults to (1, -1, 1, 1).</span>
<span class="sd">            sharding_axis_names (Sequence[str], optional): Names of the sharding axes. Defaults to (&quot;dp&quot;, &quot;fsdp&quot;, &quot;tp&quot;, &quot;sp&quot;).</span>
<span class="sd">            query_partition_spec (PartitionSpec, optional): Partitioning specification for the query tensor. Defaults to</span>
<span class="sd">                PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None).</span>
<span class="sd">            generation_query_partition_spec (PartitionSpec, optional): Partitioning specification for the query tensor during</span>
<span class="sd">                generation. Defaults to PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, &quot;tp&quot;, None).</span>
<span class="sd">            key_partition_spec (PartitionSpec, optional): Partitioning specification for the key tensor. Defaults to</span>
<span class="sd">                PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None).</span>
<span class="sd">            value_partition_spec (PartitionSpec, optional): Partitioning specification for the value tensor. Defaults to</span>
<span class="sd">                PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None).</span>
<span class="sd">            bias_partition_spec (PartitionSpec, optional): Partitioning specification for the attention bias. Defaults to</span>
<span class="sd">                PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, None, None).</span>
<span class="sd">            generation_bias_partition_spec (PartitionSpec, optional): Partitioning specification for the attention bias during</span>
<span class="sd">                generation. Defaults to PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, None, None).</span>
<span class="sd">            attention_partition_spec (PartitionSpec, optional): Partitioning specification for the attention weights. Defaults to</span>
<span class="sd">                PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None).</span>
<span class="sd">            shard_attention_computation (bool, optional): Whether to shard attention computation. Defaults to True.</span>
<span class="sd">            input_shape (Tuple[int, int], optional): Shape of the input to the model. Defaults to (1, 1).</span>
<span class="sd">            shard_fns (Optional[Mapping[tuple, Callable] | dict], optional): Sharding functions to use for the model. If None,</span>
<span class="sd">                auto-sharding is used if auto_shard_params is True. Defaults to None.</span>
<span class="sd">            backend (Optional[str], optional): Backend to use for the model. Defaults to None.</span>
<span class="sd">            config_kwargs (Optional[Mapping[str, Any]], optional): Configuration keyword arguments to pass to the model config.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">            auto_shard_params (bool, optional): Whether to automatically shard the model parameters. Defaults to False.</span>
<span class="sd">            partition_rules (Optional[Tuple[Tuple[str, PartitionSpec]]], optional): Custom partition rules for parameter</span>
<span class="sd">                sharding. If not None, shard_fns should also be provided. Defaults to None.</span>
<span class="sd">            load_in_8bit (bool, optional): Whether to load the model parameters in 8-bit precision. Defaults to False.</span>
<span class="sd">            bit_targeted_params (Optional[List[str]], optional): List of parameter names to convert to 8-bit precision. If</span>
<span class="sd">                None and load_in_8bit is True, all kernels and embeddings are converted to 8-bit. Defaults to None.</span>
<span class="sd">            verbose_params (bool): whenever to log number of parameters in converting state.</span>
<span class="sd">            **kwargs: Additional keyword arguments to pass to the model and config classes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[EasyDeLFlaxPretrainedModel, dict]: A tuple containing the EasyDeL model and the loaded and sharded</span>
<span class="sd">                model parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading model config from </span><span class="si">{</span><span class="n">pretrained_model_name_or_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">)</span>
        <span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">model_type</span>

        <span class="n">cfg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">trf</span> <span class="o">=</span> <span class="n">get_modules_by_type</span><span class="p">(</span><span class="n">model_type</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading model weights from </span><span class="si">{</span><span class="n">pretrained_model_name_or_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForCausalLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose_params</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PyTorch - HF Model contains </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">}</span><span class="s2"> Billion Parameters&quot;</span><span class="p">)</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">)</span>
        <span class="n">t_state_dict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
        <span class="k">del</span> <span class="n">model</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;adding model basic EasyDeL configurations.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="s1">&#39;add_jax_args&#39;</span><span class="p">):</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">add_jax_args</span><span class="p">()</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">add_basic_configurations</span><span class="p">(</span>
            <span class="n">axis_dims</span><span class="o">=</span><span class="n">sharding_axis_dims</span><span class="p">,</span>
            <span class="n">axis_names</span><span class="o">=</span><span class="n">sharding_axis_names</span><span class="p">,</span>
            <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">query_partition_spec</span><span class="p">,</span>
            <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">generation_query_partition_spec</span><span class="p">,</span>
            <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">generation_bias_partition_spec</span><span class="p">,</span>
            <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">key_partition_spec</span><span class="p">,</span>
            <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">value_partition_spec</span><span class="p">,</span>
            <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">bias_partition_spec</span><span class="p">,</span>
            <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">attention_partition_spec</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">shard_attention_computation</span><span class="o">=</span><span class="n">shard_attention_computation</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">config_kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">config_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;creating easydel model&quot;</span><span class="p">)</span>
        <span class="n">ed_model</span> <span class="o">=</span> <span class="n">module</span><span class="p">(</span>
            <span class="n">config</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span>
            <span class="n">_do_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
            <span class="n">param_dtype</span><span class="o">=</span><span class="n">param_dtype</span><span class="p">,</span>
            <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span>
            <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span>
        <span class="p">)</span>

        <span class="n">needs</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.kernel&quot;</span><span class="p">,</span> <span class="s2">&quot;.weight&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.scale&quot;</span><span class="p">,</span> <span class="s2">&quot;.weight&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.embedding&quot;</span><span class="p">,</span> <span class="s2">&quot;.weight&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span>
            <span class="nb">list</span><span class="p">(</span><span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">ed_model</span><span class="o">.</span><span class="n">params_shape_tree</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">]</span>
        <span class="n">state_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">t_state_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">tensor</span> <span class="o">=</span> <span class="n">t_state_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">needs</span><span class="p">:</span>
                <span class="n">state_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;removing </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> from weights as it was not needed by flax model&quot;</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">t_state_dict</span>
        <span class="k">if</span> <span class="n">shard_fns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">auto_shard_params</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;`auto_shard_params` will be ignored since you are passing custom sharding functions&quot;</span>
                <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;sharding model parameters based on the given shard_fns.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_flatten</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">):</span>
                <span class="n">shard_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">auto_shard_params</span><span class="p">:</span>
            <span class="n">shard_fns</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">AutoShardAndGatherFunctions</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
                <span class="n">pretrained_model_name_or_path</span><span class="o">=</span><span class="n">pretrained_model_name_or_path</span><span class="p">,</span>
                <span class="n">dtype_specs</span><span class="o">=</span><span class="n">param_dtype</span><span class="p">,</span>
                <span class="n">partition_rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">,</span>
                <span class="n">sharding_axis_dims</span><span class="o">=</span><span class="n">sharding_axis_dims</span><span class="p">,</span>
                <span class="n">sharding_axis_names</span><span class="o">=</span><span class="n">sharding_axis_names</span><span class="p">,</span>
                <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">query_partition_spec</span><span class="p">,</span>
                <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">generation_query_partition_spec</span><span class="p">,</span>
                <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">key_partition_spec</span><span class="p">,</span>
                <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">value_partition_spec</span><span class="p">,</span>
                <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">bias_partition_spec</span><span class="p">,</span>
                <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">generation_bias_partition_spec</span><span class="p">,</span>
                <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">attention_partition_spec</span><span class="p">,</span>
                <span class="n">shard_attention_computation</span><span class="o">=</span><span class="n">shard_attention_computation</span><span class="p">,</span>
                <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">,</span>  <span class="c1"># type:ignore</span>
                <span class="n">config_kwargs</span><span class="o">=</span><span class="n">config_kwargs</span>
            <span class="p">)</span>
        <span class="k">with</span> <span class="n">cfg</span><span class="o">.</span><span class="n">jax_mesh</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting huggingface-model to easydel-model.&quot;</span><span class="p">)</span>
            <span class="n">params_pattern_selection</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">load_in_8bit</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">bit_targeted_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                        <span class="s2">&quot;since `bit_targeted_params` is set to None, auto loader will convert all of&quot;</span>
                        <span class="s2">&quot; kernels(weights) and embeddings to 8bit by default&quot;</span>
                    <span class="p">)</span>
                    <span class="n">bit_targeted_params</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="s2">&quot;kernel&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;embedding&quot;</span>
                    <span class="p">]</span>

                    <span class="n">params_pattern_selection</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bit_targeted_params</span><span class="p">)))</span>

            <span class="n">params</span> <span class="o">=</span> <span class="n">trf</span><span class="p">(</span>
                <span class="n">state_dict</span><span class="p">,</span>
                <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
                <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
                <span class="n">shard_fns</span><span class="o">=</span><span class="n">shard_fns</span><span class="p">,</span>
                <span class="n">convert_to_8bit</span><span class="o">=</span><span class="n">load_in_8bit</span><span class="p">,</span>
                <span class="n">params_pattern_selection</span><span class="o">=</span><span class="n">params_pattern_selection</span><span class="p">,</span>
                <span class="n">remove_state_dict</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;deleting huggingface-model&quot;</span><span class="p">)</span>

        <span class="k">del</span> <span class="n">state_dict</span>
        <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">is_flatten</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;converted parameters are flatten making them unflatten &quot;</span><span class="p">)</span>
            <span class="n">params</span> <span class="o">=</span> <span class="n">unflatten_dict</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose_params</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;JAX - EasyDeL Model contains </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">size</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_flatten</span><span class="p">(</span><span class="n">flax</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">(</span><span class="n">params</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">}</span><span class="s2"> Billion Parameters&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">ed_model</span><span class="p">,</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="src.python.easydel.modules.auto_easydel_model.AutoEasyDeLModelForCausalLM.from_pretrained" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">devices</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">param_dtype</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="s1">&#39;fastest&#39;</span><span class="p">),</span> <span class="n">sharding_axis_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sharding_axis_names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">),</span> <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">shard_attention_computation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">shard_fns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">config_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_shard_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">partition_rules</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">load_in_8bit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bit_targeted_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Loads and shards a pretrained causal language model from the Hugging Face Hub and converts it into an
EasyDeL compatible model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pretrained_model_name_or_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path or name of the pretrained model in the Hugging Face Hub.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>device</code></td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Device to load the model on. Defaults to the first CPU.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.devices">devices</span>(&#39;cpu&#39;)[0]</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dtype</code></td>
            <td>
                  <code><span title="jax.numpy.dtype">dtype</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the model. Defaults to jax.numpy.float32.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.float32">float32</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>param_dtype</code></td>
            <td>
                  <code><span title="jax.numpy.dtype">dtype</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the model parameters. Defaults to jax.numpy.float32.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.float32">float32</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>precision</code></td>
            <td>
                  <code><span title="jax.lax.Precision">Precision</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Precision for computations. Defaults to jax.lax.Precision("fastest").</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.lax.Precision">Precision</span>(&#39;fastest&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sharding_axis_dims</code></td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dimensions of each sharding axis. Defaults to (1, -1, 1, 1).</p>
              </div>
            </td>
            <td>
                  <code>(1, -1, 1, 1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sharding_axis_names</code></td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the sharding axes. Defaults to ("dp", "fsdp", "tp", "sp").</p>
              </div>
            </td>
            <td>
                  <code>(&#39;dp&#39;, &#39;fsdp&#39;, &#39;tp&#39;, &#39;sp&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>query_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partitioning specification for the query tensor. Defaults to
PartitionSpec(("dp", "fsdp"), "sp", "tp", None).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>generation_query_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partitioning specification for the query tensor during
generation. Defaults to PartitionSpec(("dp", "fsdp"), None, "tp", None).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), None, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>key_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partitioning specification for the key tensor. Defaults to
PartitionSpec(("dp", "fsdp"), "sp", "tp", None).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>value_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partitioning specification for the value tensor. Defaults to
PartitionSpec(("dp", "fsdp"), "sp", "tp", None).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>bias_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partitioning specification for the attention bias. Defaults to
PartitionSpec(("dp", "fsdp"), None, None, None).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), None, None, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>generation_bias_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partitioning specification for the attention bias during
generation. Defaults to PartitionSpec(("dp", "fsdp"), None, None, None).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), None, None, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>attention_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Partitioning specification for the attention weights. Defaults to
PartitionSpec(("dp", "fsdp"), "sp", "tp", None).</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shard_attention_computation</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to shard attention computation. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>input_shape</code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Shape of the input to the model. Defaults to (1, 1).</p>
              </div>
            </td>
            <td>
                  <code>(1, 1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shard_fns</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Mapping">Mapping</span>[tuple, <span title="typing.Callable">Callable</span>] | dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sharding functions to use for the model. If None,
auto-sharding is used if auto_shard_params is True. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>backend</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Backend to use for the model. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config_kwargs</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Mapping">Mapping</span>[str, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Configuration keyword arguments to pass to the model config.
Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>auto_shard_params</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to automatically shard the model parameters. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>partition_rules</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[<span title="typing.Tuple">Tuple</span>[str, <span title="jax.sharding.PartitionSpec">PartitionSpec</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Custom partition rules for parameter
sharding. If not None, shard_fns should also be provided. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>load_in_8bit</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to load the model parameters in 8-bit precision. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>bit_targeted_params</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of parameter names to convert to 8-bit precision. If
None and load_in_8bit is True, all kernels and embeddings are converted to 8-bit. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>verbose_params</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>whenever to log number of parameters in converting state.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>**kwargs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to the model and config classes.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<a class="autorefs autorefs-internal" title="src.python.easydel.modules.easydel_modelling_utils.EasyDeLFlaxPretrainedModel" href="../generated-modules-easydel_modelling_utils/#src.python.easydel.modules.easydel_modelling_utils.EasyDeLFlaxPretrainedModel">EasyDeLFlaxPretrainedModel</a>, dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[EasyDeLFlaxPretrainedModel, dict]: A tuple containing the EasyDeL model and the loaded and sharded
model parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pretrained</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">pretrained_model_name_or_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">device</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">devices</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
        <span class="n">param_dtype</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span>
        <span class="n">precision</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">Precision</span><span class="p">]</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">lax</span><span class="o">.</span><span class="n">Precision</span><span class="p">(</span><span class="s2">&quot;fastest&quot;</span><span class="p">),</span>
        <span class="n">sharding_axis_dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">sharding_axis_names</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp&quot;</span><span class="p">),</span>
        <span class="n">query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">generation_query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">key_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">value_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">generation_bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">attention_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">shard_attention_computation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">shard_fns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">backend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">config_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">auto_shard_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">],</span> <span class="o">...</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">load_in_8bit</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">bit_targeted_params</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">verbose_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">EasyDeLFlaxPretrainedModel</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Loads and shards a pretrained causal language model from the Hugging Face Hub and converts it into an</span>
<span class="sd">    EasyDeL compatible model.</span>

<span class="sd">    Args:</span>
<span class="sd">        pretrained_model_name_or_path (str): Path or name of the pretrained model in the Hugging Face Hub.</span>
<span class="sd">        device (jax.Array, optional): Device to load the model on. Defaults to the first CPU.</span>
<span class="sd">        dtype (jax.numpy.dtype, optional): Data type of the model. Defaults to jax.numpy.float32.</span>
<span class="sd">        param_dtype (jax.numpy.dtype, optional): Data type of the model parameters. Defaults to jax.numpy.float32.</span>
<span class="sd">        precision (jax.lax.Precision, optional): Precision for computations. Defaults to jax.lax.Precision(&quot;fastest&quot;).</span>
<span class="sd">        sharding_axis_dims (Sequence[int], optional): Dimensions of each sharding axis. Defaults to (1, -1, 1, 1).</span>
<span class="sd">        sharding_axis_names (Sequence[str], optional): Names of the sharding axes. Defaults to (&quot;dp&quot;, &quot;fsdp&quot;, &quot;tp&quot;, &quot;sp&quot;).</span>
<span class="sd">        query_partition_spec (PartitionSpec, optional): Partitioning specification for the query tensor. Defaults to</span>
<span class="sd">            PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None).</span>
<span class="sd">        generation_query_partition_spec (PartitionSpec, optional): Partitioning specification for the query tensor during</span>
<span class="sd">            generation. Defaults to PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, &quot;tp&quot;, None).</span>
<span class="sd">        key_partition_spec (PartitionSpec, optional): Partitioning specification for the key tensor. Defaults to</span>
<span class="sd">            PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None).</span>
<span class="sd">        value_partition_spec (PartitionSpec, optional): Partitioning specification for the value tensor. Defaults to</span>
<span class="sd">            PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None).</span>
<span class="sd">        bias_partition_spec (PartitionSpec, optional): Partitioning specification for the attention bias. Defaults to</span>
<span class="sd">            PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, None, None).</span>
<span class="sd">        generation_bias_partition_spec (PartitionSpec, optional): Partitioning specification for the attention bias during</span>
<span class="sd">            generation. Defaults to PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, None, None).</span>
<span class="sd">        attention_partition_spec (PartitionSpec, optional): Partitioning specification for the attention weights. Defaults to</span>
<span class="sd">            PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None).</span>
<span class="sd">        shard_attention_computation (bool, optional): Whether to shard attention computation. Defaults to True.</span>
<span class="sd">        input_shape (Tuple[int, int], optional): Shape of the input to the model. Defaults to (1, 1).</span>
<span class="sd">        shard_fns (Optional[Mapping[tuple, Callable] | dict], optional): Sharding functions to use for the model. If None,</span>
<span class="sd">            auto-sharding is used if auto_shard_params is True. Defaults to None.</span>
<span class="sd">        backend (Optional[str], optional): Backend to use for the model. Defaults to None.</span>
<span class="sd">        config_kwargs (Optional[Mapping[str, Any]], optional): Configuration keyword arguments to pass to the model config.</span>
<span class="sd">            Defaults to None.</span>
<span class="sd">        auto_shard_params (bool, optional): Whether to automatically shard the model parameters. Defaults to False.</span>
<span class="sd">        partition_rules (Optional[Tuple[Tuple[str, PartitionSpec]]], optional): Custom partition rules for parameter</span>
<span class="sd">            sharding. If not None, shard_fns should also be provided. Defaults to None.</span>
<span class="sd">        load_in_8bit (bool, optional): Whether to load the model parameters in 8-bit precision. Defaults to False.</span>
<span class="sd">        bit_targeted_params (Optional[List[str]], optional): List of parameter names to convert to 8-bit precision. If</span>
<span class="sd">            None and load_in_8bit is True, all kernels and embeddings are converted to 8-bit. Defaults to None.</span>
<span class="sd">        verbose_params (bool): whenever to log number of parameters in converting state.</span>
<span class="sd">        **kwargs: Additional keyword arguments to pass to the model and config classes.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[EasyDeLFlaxPretrainedModel, dict]: A tuple containing the EasyDeL model and the loaded and sharded</span>
<span class="sd">            model parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading model config from </span><span class="si">{</span><span class="n">pretrained_model_name_or_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">AutoConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">)</span>
    <span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">model_type</span>

    <span class="n">cfg</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">trf</span> <span class="o">=</span> <span class="n">get_modules_by_type</span><span class="p">(</span><span class="n">model_type</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloading model weights from </span><span class="si">{</span><span class="n">pretrained_model_name_or_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">AutoModelForCausalLM</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">verbose_params</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PyTorch - HF Model contains </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">numel</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">())</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">}</span><span class="s2"> Billion Parameters&quot;</span><span class="p">)</span>
    <span class="n">cfg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">)</span>
    <span class="n">t_state_dict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
    <span class="k">del</span> <span class="n">model</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;adding model basic EasyDeL configurations.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="s1">&#39;add_jax_args&#39;</span><span class="p">):</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">add_jax_args</span><span class="p">()</span>
    <span class="n">cfg</span><span class="o">.</span><span class="n">add_basic_configurations</span><span class="p">(</span>
        <span class="n">axis_dims</span><span class="o">=</span><span class="n">sharding_axis_dims</span><span class="p">,</span>
        <span class="n">axis_names</span><span class="o">=</span><span class="n">sharding_axis_names</span><span class="p">,</span>
        <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">query_partition_spec</span><span class="p">,</span>
        <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">generation_query_partition_spec</span><span class="p">,</span>
        <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">generation_bias_partition_spec</span><span class="p">,</span>
        <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">key_partition_spec</span><span class="p">,</span>
        <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">value_partition_spec</span><span class="p">,</span>
        <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">bias_partition_spec</span><span class="p">,</span>
        <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">attention_partition_spec</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
        <span class="n">shard_attention_computation</span><span class="o">=</span><span class="n">shard_attention_computation</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">config_kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">config_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;creating easydel model&quot;</span><span class="p">)</span>
    <span class="n">ed_model</span> <span class="o">=</span> <span class="n">module</span><span class="p">(</span>
        <span class="n">config</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span>
        <span class="n">_do_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
        <span class="n">param_dtype</span><span class="o">=</span><span class="n">param_dtype</span><span class="p">,</span>
        <span class="n">precision</span><span class="o">=</span><span class="n">precision</span><span class="p">,</span>
        <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span>
    <span class="p">)</span>

    <span class="n">needs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.kernel&quot;</span><span class="p">,</span> <span class="s2">&quot;.weight&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.scale&quot;</span><span class="p">,</span> <span class="s2">&quot;.weight&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.embedding&quot;</span><span class="p">,</span> <span class="s2">&quot;.weight&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span>
        <span class="nb">list</span><span class="p">(</span><span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">ed_model</span><span class="o">.</span><span class="n">params_shape_tree</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="p">]</span>
    <span class="n">state_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">t_state_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">tensor</span> <span class="o">=</span> <span class="n">t_state_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">needs</span><span class="p">:</span>
            <span class="n">state_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">tensor</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;removing </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2"> from weights as it was not needed by flax model&quot;</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">t_state_dict</span>
    <span class="k">if</span> <span class="n">shard_fns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">auto_shard_params</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;`auto_shard_params` will be ignored since you are passing custom sharding functions&quot;</span>
            <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;sharding model parameters based on the given shard_fns.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_flatten</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">):</span>
            <span class="n">shard_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">auto_shard_params</span><span class="p">:</span>
        <span class="n">shard_fns</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">AutoShardAndGatherFunctions</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
            <span class="n">pretrained_model_name_or_path</span><span class="o">=</span><span class="n">pretrained_model_name_or_path</span><span class="p">,</span>
            <span class="n">dtype_specs</span><span class="o">=</span><span class="n">param_dtype</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">,</span>
            <span class="n">sharding_axis_dims</span><span class="o">=</span><span class="n">sharding_axis_dims</span><span class="p">,</span>
            <span class="n">sharding_axis_names</span><span class="o">=</span><span class="n">sharding_axis_names</span><span class="p">,</span>
            <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">query_partition_spec</span><span class="p">,</span>
            <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">generation_query_partition_spec</span><span class="p">,</span>
            <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">key_partition_spec</span><span class="p">,</span>
            <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">value_partition_spec</span><span class="p">,</span>
            <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">bias_partition_spec</span><span class="p">,</span>
            <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">generation_bias_partition_spec</span><span class="p">,</span>
            <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">attention_partition_spec</span><span class="p">,</span>
            <span class="n">shard_attention_computation</span><span class="o">=</span><span class="n">shard_attention_computation</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
            <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">,</span>  <span class="c1"># type:ignore</span>
            <span class="n">config_kwargs</span><span class="o">=</span><span class="n">config_kwargs</span>
        <span class="p">)</span>
    <span class="k">with</span> <span class="n">cfg</span><span class="o">.</span><span class="n">jax_mesh</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;converting huggingface-model to easydel-model.&quot;</span><span class="p">)</span>
        <span class="n">params_pattern_selection</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">load_in_8bit</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">bit_targeted_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;since `bit_targeted_params` is set to None, auto loader will convert all of&quot;</span>
                    <span class="s2">&quot; kernels(weights) and embeddings to 8bit by default&quot;</span>
                <span class="p">)</span>
                <span class="n">bit_targeted_params</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="s2">&quot;kernel&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;embedding&quot;</span>
                <span class="p">]</span>

                <span class="n">params_pattern_selection</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bit_targeted_params</span><span class="p">)))</span>

        <span class="n">params</span> <span class="o">=</span> <span class="n">trf</span><span class="p">(</span>
            <span class="n">state_dict</span><span class="p">,</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
            <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">,</span>
            <span class="n">shard_fns</span><span class="o">=</span><span class="n">shard_fns</span><span class="p">,</span>
            <span class="n">convert_to_8bit</span><span class="o">=</span><span class="n">load_in_8bit</span><span class="p">,</span>
            <span class="n">params_pattern_selection</span><span class="o">=</span><span class="n">params_pattern_selection</span><span class="p">,</span>
            <span class="n">remove_state_dict</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;deleting huggingface-model&quot;</span><span class="p">)</span>

    <span class="k">del</span> <span class="n">state_dict</span>
    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">is_flatten</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;converted parameters are flatten making them unflatten &quot;</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">unflatten_dict</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose_params</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;JAX - EasyDeL Model contains </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">size</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_flatten</span><span class="p">(</span><span class="n">flax</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">unfreeze</span><span class="p">(</span><span class="n">params</span><span class="p">))[</span><span class="mi">0</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">}</span><span class="s2"> Billion Parameters&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">ed_model</span><span class="p">,</span> <span class="n">params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions" class="doc doc-heading">
            <code>AutoShardAndGatherFunctions</code>


</h2>


    <div class="doc doc-contents ">


      <p>A class to automatically generate shard and gather functions for a given model configuration.</p>
<p>This class provides two methods to generate shard and gather functions:</p>
<ul>
<li><code>from_config</code>: Generates functions based on a provided <code>EasyDeLPretrainedConfig</code> object.</li>
<li><code>from_pretrained</code>: Generates functions based on a pretrained model name or path.</li>
</ul>


<p><span class="doc-section-title">Methods:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_config" href="#src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_config">from_config</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates shard and gather functions based on a provided <code>EasyDeLPretrainedConfig</code> object.</p>
                </div>
              </td>
            </tr>
            <tr class="doc-section-item">
              <td><code><a class="autorefs autorefs-internal" title="src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_pretrained" href="#src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_pretrained">from_pretrained</a></code></td>
              <td>
                <div class="doc-md-description">
                  <p>Generates functions based on a pretrained model name or path.</p>
                </div>
              </td>
            </tr>
      </tbody>
    </table>

              <details class="quote">
                <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">AutoShardAndGatherFunctions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to automatically generate shard and gather functions for a given model configuration.</span>

<span class="sd">    This class provides two methods to generate shard and gather functions:</span>

<span class="sd">    - `from_config`: Generates functions based on a provided `EasyDeLPretrainedConfig` object.</span>
<span class="sd">    - `from_pretrained`: Generates functions based on a pretrained model name or path.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        None</span>

<span class="sd">    Methods:</span>
<span class="sd">        from_config: Generates shard and gather functions based on a provided `EasyDeLPretrainedConfig` object.</span>
<span class="sd">        from_pretrained: Generates functions based on a pretrained model name or path.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_config</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">config</span><span class="p">:</span> <span class="n">EasyDeLPretrainedConfig</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">flatten</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">dtype_specs</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span>
            <span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">depth_target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates shard and gather functions based on a provided `EasyDeLPretrainedConfig` object.</span>

<span class="sd">        Args:</span>
<span class="sd">            config: An `EasyDeLPretrainedConfig` object containing the model configuration.</span>
<span class="sd">            partition_rules: A tuple of tuples containing partition rule names and `PartitionSpec` objects.</span>
<span class="sd">                If None, uses the default partition rules from the `config`.</span>
<span class="sd">            flatten: Whether to flatten the shard and gather functions. Defaults to True.</span>
<span class="sd">            dtype_specs: The data type to use for the shard and gather functions. Defaults to `jax.numpy.float16`.</span>
<span class="sd">            input_shape: The input shape of the model. Defaults to (1, 1).</span>
<span class="sd">            depth_target: Pad the sharding to depth, for example make {params:tensor} with depth_target = [&quot;row&quot;] to {row:{params:tensor}}. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple containing the shard and gather functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">partition_rules</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Using config partition rules from `get_partition_rules(fully_sharded_data_parallel=True)`&quot;</span><span class="p">)</span>
            <span class="n">partition_rules</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_partition_rules</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_modules_by_type</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">model_type</span><span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">module</span><span class="p">(</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
            <span class="n">_do_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span>
        <span class="p">)</span>

        <span class="n">partition_specs</span> <span class="o">=</span> <span class="n">match_partition_rules</span><span class="p">(</span>
            <span class="n">partition_rules</span><span class="p">,</span>
            <span class="n">model</span><span class="o">.</span><span class="n">params_shape_tree</span>
        <span class="p">)</span>
        <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span> <span class="o">=</span> <span class="n">make_shard_and_gather_fns</span><span class="p">(</span>
            <span class="n">partition_specs</span><span class="o">=</span><span class="n">partition_specs</span><span class="p">,</span>
            <span class="n">dtype_specs</span><span class="o">=</span><span class="n">dtype_specs</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">depth_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="n">depth_target</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">gather_fns</span> <span class="o">=</span> <span class="p">{</span><span class="n">dp</span><span class="p">:</span> <span class="n">gather_fns</span><span class="p">}</span>
                <span class="n">shard_fns</span> <span class="o">=</span> <span class="p">{</span><span class="n">dp</span><span class="p">:</span> <span class="n">shard_fns</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">flatten</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_flatten</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">):</span>
            <span class="n">gather_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">gather_fns</span><span class="p">)</span>
            <span class="n">shard_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">flatten</span> <span class="ow">and</span> <span class="n">is_flatten</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">):</span>
            <span class="n">gather_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">unflatten_dict</span><span class="p">(</span><span class="n">gather_fns</span><span class="p">)</span>
            <span class="n">shard_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">unflatten_dict</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_pretrained</span><span class="p">(</span>
            <span class="bp">cls</span><span class="p">,</span>
            <span class="n">pretrained_model_name_or_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
            <span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">sharding_axis_dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">sharding_axis_names</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp&quot;</span><span class="p">),</span>
            <span class="n">query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">generation_query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">key_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">value_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">generation_bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">attention_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">shard_attention_computation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">backend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">flatten</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
            <span class="n">dtype_specs</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span>
            <span class="n">config_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">depth_target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates shard and gather functions based on a pretrained model name or path.</span>

<span class="sd">        Args:</span>
<span class="sd">            pretrained_model_name_or_path: The name or path of the pretrained model.</span>
<span class="sd">            input_shape: The input shape of the model. Defaults to (1, 1).</span>
<span class="sd">            sharding_axis_dims: The dimensions of the sharding axes. Defaults to (1, -1, 1, 1).</span>
<span class="sd">            sharding_axis_names: The names of the sharding axes. Defaults to (&quot;dp&quot;, &quot;fsdp&quot;, &quot;tp&quot;, &quot;sp&quot;).</span>
<span class="sd">            query_partition_spec: The partition specification for the query matrix. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None)`.</span>
<span class="sd">            generation_query_partition_spec: The partition specification for the generation query matrix. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, None, None)`.</span>
<span class="sd">            key_partition_spec: The partition specification for the key matrix. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None)`.</span>
<span class="sd">            value_partition_spec: The partition specification for the value matrix. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None)`.</span>
<span class="sd">            bias_partition_spec: The partition specification for the bias. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, None, None)`.</span>
<span class="sd">            generation_bias_partition_spec: The partition specification for the generation bias. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, None, None)`.</span>
<span class="sd">            attention_partition_spec: The partition specification for the attention computation. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None)`.</span>
<span class="sd">            shard_attention_computation: Whether to shard the attention computation. Defaults to True.</span>
<span class="sd">            backend: The backend to use for sharding. Defaults to None.</span>
<span class="sd">            partition_rules: A tuple of tuples containing partition rule names and `PartitionSpec` objects.</span>
<span class="sd">                If None, uses the default partition rules from the `config`.</span>
<span class="sd">            flatten: Whether to flatten the shard and gather functions. Defaults to True.</span>
<span class="sd">            dtype_specs: The data type to use for the shard and gather functions. Defaults to `jax.numpy.float16`.</span>
<span class="sd">            config_kwargs: Additional keyword arguments to pass to the `AutoEasyDeLConfig` constructor. Defaults to None.</span>
<span class="sd">            depth_target: Pad the sharding to depth, for example make {params:tensor} with depth_target = [&quot;row&quot;] to {row:{params:tensor}}. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple containing the shard and gather functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">AutoEasyDeLConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
            <span class="n">pretrained_model_name_or_path</span><span class="p">,</span>
            <span class="n">sharding_axis_dims</span><span class="o">=</span><span class="n">sharding_axis_dims</span><span class="p">,</span>
            <span class="n">sharding_axis_names</span><span class="o">=</span><span class="n">sharding_axis_names</span><span class="p">,</span>
            <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">query_partition_spec</span><span class="p">,</span>
            <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">generation_query_partition_spec</span><span class="p">,</span>
            <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">key_partition_spec</span><span class="p">,</span>
            <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">value_partition_spec</span><span class="p">,</span>
            <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">bias_partition_spec</span><span class="p">,</span>
            <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">generation_bias_partition_spec</span><span class="p">,</span>
            <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">attention_partition_spec</span><span class="p">,</span>
            <span class="n">shard_attention_computation</span><span class="o">=</span><span class="n">shard_attention_computation</span><span class="p">,</span>
            <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">config_kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">config_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span>
            <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
            <span class="n">partition_rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">,</span>
            <span class="n">flatten</span><span class="o">=</span><span class="n">flatten</span><span class="p">,</span>
            <span class="n">dtype_specs</span><span class="o">=</span><span class="n">dtype_specs</span><span class="p">,</span>
            <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">,</span>
            <span class="n">depth_target</span><span class="o">=</span><span class="n">depth_target</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_config</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">partition_rules</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype_specs</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">depth_target</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Generates shard and gather functions based on a provided <code>EasyDeLPretrainedConfig</code> object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>config</code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="src.python.easydel.modules.easydel_modelling_utils.EasyDeLPretrainedConfig" href="../generated-modules-easydel_modelling_utils/#src.python.easydel.modules.easydel_modelling_utils.EasyDeLPretrainedConfig">EasyDeLPretrainedConfig</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An <code>EasyDeLPretrainedConfig</code> object containing the model configuration.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>partition_rules</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[<span title="typing.Tuple">Tuple</span>[str, <span title="jax.sharding.PartitionSpec">PartitionSpec</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of tuples containing partition rule names and <code>PartitionSpec</code> objects.
If None, uses the default partition rules from the <code>config</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>flatten</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to flatten the shard and gather functions. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dtype_specs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data type to use for the shard and gather functions. Defaults to <code>jax.numpy.float16</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.float16">float16</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>input_shape</code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input shape of the model. Defaults to (1, 1).</p>
              </div>
            </td>
            <td>
                  <code>(1, 1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>depth_target</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pad the sharding to depth, for example make {params:tensor} with depth_target = ["row"] to {row:{params:tensor}}. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the shard and gather functions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_config</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">config</span><span class="p">:</span> <span class="n">EasyDeLPretrainedConfig</span><span class="p">,</span>
        <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">flatten</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">dtype_specs</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span>
        <span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">depth_target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates shard and gather functions based on a provided `EasyDeLPretrainedConfig` object.</span>

<span class="sd">    Args:</span>
<span class="sd">        config: An `EasyDeLPretrainedConfig` object containing the model configuration.</span>
<span class="sd">        partition_rules: A tuple of tuples containing partition rule names and `PartitionSpec` objects.</span>
<span class="sd">            If None, uses the default partition rules from the `config`.</span>
<span class="sd">        flatten: Whether to flatten the shard and gather functions. Defaults to True.</span>
<span class="sd">        dtype_specs: The data type to use for the shard and gather functions. Defaults to `jax.numpy.float16`.</span>
<span class="sd">        input_shape: The input shape of the model. Defaults to (1, 1).</span>
<span class="sd">        depth_target: Pad the sharding to depth, for example make {params:tensor} with depth_target = [&quot;row&quot;] to {row:{params:tensor}}. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing the shard and gather functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">partition_rules</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Using config partition rules from `get_partition_rules(fully_sharded_data_parallel=True)`&quot;</span><span class="p">)</span>
        <span class="n">partition_rules</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get_partition_rules</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">module</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_modules_by_type</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">model_type</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">module</span><span class="p">(</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">_do_init</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span>
    <span class="p">)</span>

    <span class="n">partition_specs</span> <span class="o">=</span> <span class="n">match_partition_rules</span><span class="p">(</span>
        <span class="n">partition_rules</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">params_shape_tree</span>
    <span class="p">)</span>
    <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span> <span class="o">=</span> <span class="n">make_shard_and_gather_fns</span><span class="p">(</span>
        <span class="n">partition_specs</span><span class="o">=</span><span class="n">partition_specs</span><span class="p">,</span>
        <span class="n">dtype_specs</span><span class="o">=</span><span class="n">dtype_specs</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">depth_target</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">dp</span> <span class="ow">in</span> <span class="n">depth_target</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">gather_fns</span> <span class="o">=</span> <span class="p">{</span><span class="n">dp</span><span class="p">:</span> <span class="n">gather_fns</span><span class="p">}</span>
            <span class="n">shard_fns</span> <span class="o">=</span> <span class="p">{</span><span class="n">dp</span><span class="p">:</span> <span class="n">shard_fns</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">flatten</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">is_flatten</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">):</span>
        <span class="n">gather_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">gather_fns</span><span class="p">)</span>
        <span class="n">shard_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">flatten_dict</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">flatten</span> <span class="ow">and</span> <span class="n">is_flatten</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">):</span>
        <span class="n">gather_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">unflatten_dict</span><span class="p">(</span><span class="n">gather_fns</span><span class="p">)</span>
        <span class="n">shard_fns</span> <span class="o">=</span> <span class="n">flax</span><span class="o">.</span><span class="n">traverse_util</span><span class="o">.</span><span class="n">unflatten_dict</span><span class="p">(</span><span class="n">shard_fns</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">shard_fns</span><span class="p">,</span> <span class="n">gather_fns</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="src.python.easydel.modules.auto_easydel_model.AutoShardAndGatherFunctions.from_pretrained" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_pretrained</span><span class="p">(</span><span class="n">pretrained_model_name_or_path</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sharding_axis_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">sharding_axis_names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="s1">&#39;sp&#39;</span><span class="p">),</span> <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">PartitionSpec</span><span class="p">((</span><span class="s1">&#39;dp&#39;</span><span class="p">,</span> <span class="s1">&#39;fsdp&#39;</span><span class="p">),</span> <span class="s1">&#39;sp&#39;</span><span class="p">,</span> <span class="s1">&#39;tp&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="n">shard_attention_computation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">partition_rules</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype_specs</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span> <span class="n">config_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">depth_target</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

      <p>Generates shard and gather functions based on a pretrained model name or path.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pretrained_model_name_or_path</code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name or path of the pretrained model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>input_shape</code></td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input shape of the model. Defaults to (1, 1).</p>
              </div>
            </td>
            <td>
                  <code>(1, 1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sharding_axis_dims</code></td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dimensions of the sharding axes. Defaults to (1, -1, 1, 1).</p>
              </div>
            </td>
            <td>
                  <code>(1, -1, 1, 1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>sharding_axis_names</code></td>
            <td>
                  <code><span title="typing.Sequence">Sequence</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The names of the sharding axes. Defaults to ("dp", "fsdp", "tp", "sp").</p>
              </div>
            </td>
            <td>
                  <code>(&#39;dp&#39;, &#39;fsdp&#39;, &#39;tp&#39;, &#39;sp&#39;)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>query_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The partition specification for the query matrix. Defaults to <code>PartitionSpec(("dp", "fsdp"), "sp", "tp", None)</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>generation_query_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The partition specification for the generation query matrix. Defaults to <code>PartitionSpec(("dp", "fsdp"), "sp", None, None)</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, None, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>key_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The partition specification for the key matrix. Defaults to <code>PartitionSpec(("dp", "fsdp"), "sp", "tp", None)</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>value_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The partition specification for the value matrix. Defaults to <code>PartitionSpec(("dp", "fsdp"), "sp", "tp", None)</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>bias_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The partition specification for the bias. Defaults to <code>PartitionSpec(("dp", "fsdp"), None, None, None)</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), None, None, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>generation_bias_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The partition specification for the generation bias. Defaults to <code>PartitionSpec(("dp", "fsdp"), None, None, None)</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), None, None, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>attention_partition_spec</code></td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The partition specification for the attention computation. Defaults to <code>PartitionSpec(("dp", "fsdp"), "sp", "tp", None)</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.sharding.PartitionSpec">PartitionSpec</span>((&#39;dp&#39;, &#39;fsdp&#39;), &#39;sp&#39;, &#39;tp&#39;, None)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>shard_attention_computation</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to shard the attention computation. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>backend</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The backend to use for sharding. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>partition_rules</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Tuple">Tuple</span>[<span title="typing.Tuple">Tuple</span>[str, <span title="jax.sharding.PartitionSpec">PartitionSpec</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of tuples containing partition rule names and <code>PartitionSpec</code> objects.
If None, uses the default partition rules from the <code>config</code>.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>flatten</code></td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to flatten the shard and gather functions. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>dtype_specs</code></td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data type to use for the shard and gather functions. Defaults to <code>jax.numpy.float16</code>.</p>
              </div>
            </td>
            <td>
                  <code><span title="jax.numpy.float16">float16</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>config_kwargs</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Mapping">Mapping</span>[str, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to the <code>AutoEasyDeLConfig</code> constructor. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code>depth_target</code></td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.List">List</span>[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Pad the sharding to depth, for example make {params:tensor} with depth_target = ["row"] to {row:{params:tensor}}. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="typing.Mapping">Mapping</span>[str, <span title="typing.Callable">Callable</span>], <span title="typing.Mapping">Mapping</span>[str, <span title="typing.Callable">Callable</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple containing the shard and gather functions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_pretrained</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">pretrained_model_name_or_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">input_shape</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">sharding_axis_dims</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">sharding_axis_names</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="s2">&quot;sp&quot;</span><span class="p">),</span>
        <span class="n">query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">generation_query_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">key_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">value_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">generation_bias_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">attention_partition_spec</span><span class="p">:</span> <span class="n">PartitionSpec</span> <span class="o">=</span> <span class="n">PartitionSpec</span><span class="p">((</span><span class="s2">&quot;dp&quot;</span><span class="p">,</span> <span class="s2">&quot;fsdp&quot;</span><span class="p">),</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span> <span class="s2">&quot;tp&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">shard_attention_computation</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">backend</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">partition_rules</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">PartitionSpec</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">flatten</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">dtype_specs</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">float16</span><span class="p">,</span>
        <span class="n">config_kwargs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">depth_target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">],</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates shard and gather functions based on a pretrained model name or path.</span>

<span class="sd">    Args:</span>
<span class="sd">        pretrained_model_name_or_path: The name or path of the pretrained model.</span>
<span class="sd">        input_shape: The input shape of the model. Defaults to (1, 1).</span>
<span class="sd">        sharding_axis_dims: The dimensions of the sharding axes. Defaults to (1, -1, 1, 1).</span>
<span class="sd">        sharding_axis_names: The names of the sharding axes. Defaults to (&quot;dp&quot;, &quot;fsdp&quot;, &quot;tp&quot;, &quot;sp&quot;).</span>
<span class="sd">        query_partition_spec: The partition specification for the query matrix. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None)`.</span>
<span class="sd">        generation_query_partition_spec: The partition specification for the generation query matrix. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, None, None)`.</span>
<span class="sd">        key_partition_spec: The partition specification for the key matrix. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None)`.</span>
<span class="sd">        value_partition_spec: The partition specification for the value matrix. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None)`.</span>
<span class="sd">        bias_partition_spec: The partition specification for the bias. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, None, None)`.</span>
<span class="sd">        generation_bias_partition_spec: The partition specification for the generation bias. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), None, None, None)`.</span>
<span class="sd">        attention_partition_spec: The partition specification for the attention computation. Defaults to `PartitionSpec((&quot;dp&quot;, &quot;fsdp&quot;), &quot;sp&quot;, &quot;tp&quot;, None)`.</span>
<span class="sd">        shard_attention_computation: Whether to shard the attention computation. Defaults to True.</span>
<span class="sd">        backend: The backend to use for sharding. Defaults to None.</span>
<span class="sd">        partition_rules: A tuple of tuples containing partition rule names and `PartitionSpec` objects.</span>
<span class="sd">            If None, uses the default partition rules from the `config`.</span>
<span class="sd">        flatten: Whether to flatten the shard and gather functions. Defaults to True.</span>
<span class="sd">        dtype_specs: The data type to use for the shard and gather functions. Defaults to `jax.numpy.float16`.</span>
<span class="sd">        config_kwargs: Additional keyword arguments to pass to the `AutoEasyDeLConfig` constructor. Defaults to None.</span>
<span class="sd">        depth_target: Pad the sharding to depth, for example make {params:tensor} with depth_target = [&quot;row&quot;] to {row:{params:tensor}}. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A tuple containing the shard and gather functions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">AutoEasyDeLConfig</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span>
        <span class="n">pretrained_model_name_or_path</span><span class="p">,</span>
        <span class="n">sharding_axis_dims</span><span class="o">=</span><span class="n">sharding_axis_dims</span><span class="p">,</span>
        <span class="n">sharding_axis_names</span><span class="o">=</span><span class="n">sharding_axis_names</span><span class="p">,</span>
        <span class="n">query_partition_spec</span><span class="o">=</span><span class="n">query_partition_spec</span><span class="p">,</span>
        <span class="n">generation_query_partition_spec</span><span class="o">=</span><span class="n">generation_query_partition_spec</span><span class="p">,</span>
        <span class="n">key_partition_spec</span><span class="o">=</span><span class="n">key_partition_spec</span><span class="p">,</span>
        <span class="n">value_partition_spec</span><span class="o">=</span><span class="n">value_partition_spec</span><span class="p">,</span>
        <span class="n">bias_partition_spec</span><span class="o">=</span><span class="n">bias_partition_spec</span><span class="p">,</span>
        <span class="n">generation_bias_partition_spec</span><span class="o">=</span><span class="n">generation_bias_partition_spec</span><span class="p">,</span>
        <span class="n">attention_partition_spec</span><span class="o">=</span><span class="n">attention_partition_spec</span><span class="p">,</span>
        <span class="n">shard_attention_computation</span><span class="o">=</span><span class="n">shard_attention_computation</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">config_kwargs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">config_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_config</span><span class="p">(</span>
        <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span>
        <span class="n">partition_rules</span><span class="o">=</span><span class="n">partition_rules</span><span class="p">,</span>
        <span class="n">flatten</span><span class="o">=</span><span class="n">flatten</span><span class="p">,</span>
        <span class="n">dtype_specs</span><span class="o">=</span><span class="n">dtype_specs</span><span class="p">,</span>
        <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">,</span>
        <span class="n">depth_target</span><span class="o">=</span><span class="n">depth_target</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="src.python.easydel.modules.auto_easydel_model.get_modules_by_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_modules_by_type</span><span class="p">(</span><span class="n">model_type</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">



<details class="the-get_modules_by_type-function-is-a-helper-function-that-returns-the-following" open>
  <summary>The get_modules_by_type function is a helper function that returns the following</summary>
  <ol>
<li>The config class for the model type specified (e.g., LlamaConfig, FalconConfig)</li>
<li>The Flax Model class for the model type specified (e.g., FlaxLlamaForCausalLM, FlaxFalconForCausalLM)</li>
<li>A function to convert a HuggingFace pretrained checkpoint into an easydel checkpoint</li>
</ol>
</details>      <p>:param model_type: str: Determine which model to use
:return: A tuple of three elements (BaseConfig,BaseModel,Func To Transform Model from Torch to EasyDeL)</p>

            <details class="quote">
              <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_modules_by_type</span><span class="p">(</span><span class="n">model_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
    <span class="n">Type</span><span class="p">[</span><span class="n">EasyDeLPretrainedConfig</span><span class="p">],</span> <span class="n">Type</span><span class="p">[</span><span class="n">EasyDeLFlaxPretrainedModel</span><span class="p">]</span> <span class="o">|</span> <span class="n">Any</span><span class="p">,</span> <span class="n">partial</span> <span class="o">|</span> <span class="n">Any</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The get_modules_by_type function is a helper function that returns the following:</span>
<span class="sd">        1. The config class for the model type specified (e.g., LlamaConfig, FalconConfig)</span>
<span class="sd">        2. The Flax Model class for the model type specified (e.g., FlaxLlamaForCausalLM, FlaxFalconForCausalLM)</span>
<span class="sd">        3. A function to convert a HuggingFace pretrained checkpoint into an easydel checkpoint</span>

<span class="sd">    :param model_type: str: Determine which model to use</span>
<span class="sd">    :return: A tuple of three elements (BaseConfig,BaseModel,Func To Transform Model from Torch to EasyDeL)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;llama&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.llama</span> <span class="kn">import</span> <span class="n">LlamaConfig</span> <span class="k">as</span> <span class="n">_LlamaConfig</span>
        <span class="kn">from</span> <span class="nn">.llama</span> <span class="kn">import</span> <span class="n">FlaxLlamaForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxLlamaForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_LlamaConfig</span><span class="p">,</span>
            <span class="n">_FlaxLlamaForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;gemma&quot;</span><span class="p">:</span>

        <span class="kn">from</span> <span class="nn">.gemma</span> <span class="kn">import</span> <span class="n">GemmaConfig</span> <span class="k">as</span> <span class="n">_GemmaConfig</span>
        <span class="kn">from</span> <span class="nn">.gemma</span> <span class="kn">import</span> <span class="n">FlaxGemmaForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxGemmaForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_GemmaConfig</span><span class="p">,</span>
            <span class="n">_FlaxGemmaForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;falcon&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.falcon</span> <span class="kn">import</span> <span class="n">FlaxFalconForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxFalconForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.falcon</span> <span class="kn">import</span> <span class="n">FalconConfig</span> <span class="k">as</span> <span class="n">_FalconConfig</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_FalconConfig</span><span class="p">,</span>
            <span class="n">_FlaxFalconForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;word_embeddings&quot;</span><span class="p">],</span>
                <span class="n">layer_norm_names</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;input_layernorm&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ln_f&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ln_attn&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;ln_mlp&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;post_attention_layernorm&quot;</span>
                <span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;mpt&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.mosaic_mpt</span> <span class="kn">import</span> <span class="n">FlaxMptForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxMptForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.mosaic_mpt</span> <span class="kn">import</span> <span class="n">MptConfig</span> <span class="k">as</span> <span class="n">_MptConfig</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_MptConfig</span><span class="p">,</span>
            <span class="n">_FlaxMptForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wte&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">layer_norm_names</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;norm_1&quot;</span><span class="p">,</span> <span class="s2">&quot;norm_2&quot;</span><span class="p">,</span> <span class="s2">&quot;norm_f&quot;</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;mistral&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.mistral</span> <span class="kn">import</span> <span class="n">FlaxMistralForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxMistralForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.mistral</span> <span class="kn">import</span> <span class="n">MistralConfig</span> <span class="k">as</span> <span class="n">_MistralConfig</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_MistralConfig</span><span class="p">,</span>
            <span class="n">_FlaxMistralForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;gptj&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.gpt_j</span> <span class="kn">import</span> <span class="n">FlaxGPTJForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxGPTJForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.gpt_j</span> <span class="kn">import</span> <span class="n">GPTJConfig</span> <span class="k">as</span> <span class="n">_GPTJConfig</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_GPTJConfig</span><span class="p">,</span>
            <span class="n">_FlaxGPTJForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="s2">&quot;wte&quot;</span><span class="p">,</span>
                <span class="n">layer_norm_names</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;ln_1&quot;</span><span class="p">,</span> <span class="s2">&quot;ln_2&quot;</span><span class="p">,</span> <span class="s2">&quot;ln_f&quot;</span><span class="p">,</span>
                <span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;gpt_neox&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.gpt_neo_x</span> <span class="kn">import</span> <span class="n">FlaxGPTNeoXForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxGPTNeoXForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.gpt_neo_x</span> <span class="kn">import</span> <span class="n">GPTNeoXConfig</span> <span class="k">as</span> <span class="n">_GPTNeoXConfig</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_GPTNeoXConfig</span><span class="p">,</span>
            <span class="n">_FlaxGPTNeoXForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="s2">&quot;wte&quot;</span><span class="p">,</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;palm&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.palm</span> <span class="kn">import</span> <span class="n">FlaxPalmForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxPalmForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.palm</span> <span class="kn">import</span> <span class="n">PalmConfig</span> <span class="k">as</span> <span class="n">_PalmConfig</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_PalmConfig</span><span class="p">,</span>
            <span class="n">_FlaxPalmForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="s2">&quot;wte&quot;</span><span class="p">,</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;lt&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.lucid_transformer</span> <span class="kn">import</span> <span class="n">FlaxLTForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxLTForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.lucid_transformer</span> <span class="kn">import</span> <span class="n">FlaxLTConfig</span> <span class="k">as</span> <span class="n">_FlaxLTConfig</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_FlaxLTConfig</span><span class="p">,</span>
            <span class="n">_FlaxLTForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="s2">&quot;wte&quot;</span><span class="p">,</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;gpt2&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.gpt2</span> <span class="kn">import</span> <span class="n">FlaxGPT2LMHeadModel</span> <span class="k">as</span> <span class="n">_FlaxGPT2LMHeadModel</span>
        <span class="kn">from</span> <span class="nn">.gpt2</span> <span class="kn">import</span> <span class="n">GPT2Config</span> <span class="k">as</span> <span class="n">_GPT2Config</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_GPT2Config</span><span class="p">,</span>
            <span class="n">_FlaxGPT2LMHeadModel</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wte&quot;</span><span class="p">,</span> <span class="s2">&quot;wpe&quot;</span><span class="p">],</span>
                <span class="n">layer_norm_names</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;ln_1&quot;</span><span class="p">,</span> <span class="s2">&quot;ln_2&quot;</span><span class="p">,</span> <span class="s2">&quot;ln_f&quot;</span>
                <span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;mixtral&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.mixtral</span> <span class="kn">import</span> <span class="n">FlaxMixtralForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxMixtralForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.mixtral</span> <span class="kn">import</span> <span class="n">MixtralConfig</span> <span class="k">as</span> <span class="n">_MixtralConfig</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_MixtralConfig</span><span class="p">,</span>
            <span class="n">_FlaxMixtralForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;phi&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.phi</span> <span class="kn">import</span> <span class="n">FlaxPhiForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxPhiForCausalLM</span>
        <span class="kn">from</span> <span class="nn">.phi</span> <span class="kn">import</span> <span class="n">PhiConfig</span> <span class="k">as</span> <span class="n">_PhiConfig</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_PhiConfig</span><span class="p">,</span>
            <span class="n">_FlaxPhiForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">layer_norm_names</span><span class="o">=</span><span class="p">[</span>
                    <span class="s2">&quot;input_layernorm&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;final_layernorm&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;q_layernorm&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;k_layernorm&quot;</span>
                <span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;qwen&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.qwen1</span> <span class="kn">import</span> <span class="n">Qwen1Config</span> <span class="k">as</span> <span class="n">_Qwen1Config</span>
        <span class="kn">from</span> <span class="nn">.qwen1</span> <span class="kn">import</span> <span class="n">FlaxQwen1ForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxQwen1ForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_Qwen1Config</span><span class="p">,</span>
            <span class="n">_FlaxQwen1ForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wte&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;qwen2&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.qwen2</span> <span class="kn">import</span> <span class="n">Qwen2Config</span> <span class="k">as</span> <span class="n">_Qwen2Config</span>
        <span class="kn">from</span> <span class="nn">.qwen2</span> <span class="kn">import</span> <span class="n">FlaxQwen2ForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxQwen2ForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_Qwen2Config</span><span class="p">,</span>
            <span class="n">_FlaxQwen2ForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;stablelm&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.stablelm</span> <span class="kn">import</span> <span class="n">StableLmConfig</span> <span class="k">as</span> <span class="n">_StableLmConfig</span>
        <span class="kn">from</span> <span class="nn">.stablelm</span> <span class="kn">import</span> <span class="n">FlaxStableLmForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxStableLmForCausalLM</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_StableLmConfig</span><span class="p">,</span>
            <span class="n">_FlaxStableLmForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">layer_norm_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;input_layernorm&quot;</span><span class="p">,</span> <span class="s2">&quot;post_attention_layernorm&quot;</span><span class="p">,</span> <span class="s2">&quot;norm&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;rwkv&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.rwkv</span> <span class="kn">import</span> <span class="n">RwkvConfig</span> <span class="k">as</span> <span class="n">_RwkvConfig</span>
        <span class="kn">from</span> <span class="nn">.rwkv</span> <span class="kn">import</span> <span class="n">FlaxRwkvForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxRwkvForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_RwkvConfig</span><span class="p">,</span>
            <span class="n">_FlaxRwkvForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embeddings&quot;</span><span class="p">],</span>
                <span class="n">layer_norm_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;ln_out&quot;</span><span class="p">,</span> <span class="s2">&quot;ln2&quot;</span><span class="p">,</span> <span class="s2">&quot;ln1&quot;</span><span class="p">,</span> <span class="s2">&quot;pre_ln&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;mamba&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.mamba</span> <span class="kn">import</span> <span class="n">MambaConfig</span> <span class="k">as</span> <span class="n">_MambaConfig</span>
        <span class="kn">from</span> <span class="nn">.mamba</span> <span class="kn">import</span> <span class="n">FlaxMambaForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxMambaForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_MambaConfig</span><span class="p">,</span>
            <span class="n">_FlaxMambaForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embeddings&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;grok-1&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.grok_1</span> <span class="kn">import</span> <span class="n">Grok1Config</span> <span class="k">as</span> <span class="n">_Grok1Config</span>
        <span class="kn">from</span> <span class="nn">.grok_1</span> <span class="kn">import</span> <span class="n">FlaxGrok1ForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxGrok1ForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_Grok1Config</span><span class="p">,</span>
            <span class="n">_FlaxGrok1ForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;qwen2_moe&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.qwen2_moe</span> <span class="kn">import</span> <span class="n">Qwen2MoeConfig</span> <span class="k">as</span> <span class="n">_Qwen2MoeConfig</span>
        <span class="kn">from</span> <span class="nn">.qwen2_moe</span> <span class="kn">import</span> <span class="n">FlaxQwen2MoeForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxQwen2MoeForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_Qwen2MoeConfig</span><span class="p">,</span>
            <span class="n">_FlaxQwen2MoeForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;cohere&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.cohere</span> <span class="kn">import</span> <span class="n">CohereConfig</span> <span class="k">as</span> <span class="n">_CohereConfig</span>
        <span class="kn">from</span> <span class="nn">.cohere</span> <span class="kn">import</span> <span class="n">FlaxCohereForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxCohereForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_CohereConfig</span><span class="p">,</span>
            <span class="n">_FlaxCohereForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;dbrx&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.dbrx</span> <span class="kn">import</span> <span class="n">DbrxConfig</span> <span class="k">as</span> <span class="n">_DbrxConfig</span>
        <span class="kn">from</span> <span class="nn">.dbrx</span> <span class="kn">import</span> <span class="n">FlaxDbrxForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxDbrxForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_DbrxConfig</span><span class="p">,</span>
            <span class="n">_FlaxDbrxForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;wte&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">layer_norm_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;norm_1&quot;</span><span class="p">,</span> <span class="s2">&quot;norm_2&quot;</span><span class="p">,</span> <span class="s2">&quot;norm_f&quot;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;phi3&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.phi3</span> <span class="kn">import</span> <span class="n">Phi3Config</span> <span class="k">as</span> <span class="n">_Phi3Config</span>
        <span class="kn">from</span> <span class="nn">.phi3</span> <span class="kn">import</span> <span class="n">FlaxPhi3ForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxPhi3ForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_Phi3Config</span><span class="p">,</span>
            <span class="n">_FlaxPhi3ForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;arctic&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.arctic</span> <span class="kn">import</span> <span class="n">ArcticConfig</span> <span class="k">as</span> <span class="n">_ArcticConfig</span>
        <span class="kn">from</span> <span class="nn">.arctic</span> <span class="kn">import</span> <span class="n">FlaxArcticForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxArcticForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_ArcticConfig</span><span class="p">,</span>
            <span class="n">_FlaxArcticForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;openelm&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.openelm</span> <span class="kn">import</span> <span class="n">OpenELMConfig</span> <span class="k">as</span> <span class="n">_OpenELMConfig</span>
        <span class="kn">from</span> <span class="nn">.openelm</span> <span class="kn">import</span> <span class="n">FlaxOpenELMForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxOpenELMForCausalLM</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_OpenELMConfig</span><span class="p">,</span>
            <span class="n">_FlaxOpenELMForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;token_embeddings&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">model_type</span> <span class="o">==</span> <span class="s2">&quot;deepseek_v2&quot;</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">.deepseek_v2</span> <span class="kn">import</span> <span class="n">DeepseekV2Config</span> <span class="k">as</span> <span class="n">_DeepseekV2Config</span>
        <span class="kn">from</span> <span class="nn">.deepseek_v2</span> <span class="kn">import</span> <span class="n">FlaxDeepseekV2ForCausalLM</span> <span class="k">as</span> <span class="n">_FlaxDeepseekV2ForCausalLM</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">_DeepseekV2Config</span><span class="p">,</span>
            <span class="n">_FlaxDeepseekV2ForCausalLM</span><span class="p">,</span>
            <span class="n">functools</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span>
                <span class="n">huggingface_to_easydel</span><span class="p">,</span>
                <span class="n">embedding_layer_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;embed_tokens&quot;</span><span class="p">],</span>
                <span class="n">rnn_based_or_rwkv</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">raise</span> <span class="n">EasyDeLRuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Model Type (</span><span class="si">{</span><span class="n">model_type</span><span class="si">}</span><span class="s1">) is not supported or is not found&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.python.easydel.modules.auto_easydel_model.is_flatten" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_flatten</span><span class="p">(</span><span class="n">pytree</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

      <p>The is_flatten function checks if the pytree is flattened.
    If it is, then the first key in the dictionary will be a tuple of (mpl, mpl_id).
    Otherwise, it will be an integer representing mpl_id.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code>pytree</code></td>
            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>dict: Pass the pytree to the function</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the pytree is a flattened tree, and false otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>src/python/easydel/modules/auto_easydel_model.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_flatten</span><span class="p">(</span><span class="n">pytree</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The is_flatten function checks if the pytree is flattened.</span>
<span class="sd">        If it is, then the first key in the dictionary will be a tuple of (mpl, mpl_id).</span>
<span class="sd">        Otherwise, it will be an integer representing mpl_id.</span>

<span class="sd">    Args:</span>
<span class="sd">        pytree: dict: Pass the pytree to the function</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the pytree is a flattened tree, and false otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mpl</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">pytree</span><span class="o">.</span><span class="n">keys</span><span class="p">()][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mpl</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Erfan Zare Chavoshi-easydel
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.081f42fc.min.js"></script>
      
    
  </body>
</html>